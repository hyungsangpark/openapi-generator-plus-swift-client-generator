//  
//  {{>frag/generatedBy}}
//

import Foundation

/**
 A protocol defining methods for handling security within API requests.
 */
public protocol SecurityClient {
    /**
     Handles reauthentication when an API request receives a 401 response.

     - Parameters:
        - securityScheme: The security scheme to be reauthenticated.
        - scopes: Optional scopes associated with the reauthentication.

     - Throws: An error if the reauthentication process encounters an issue.

     - Note: If no errors are thrown the session will be reauthenticated and new requests should be attempted.
     */
    func reauthenticate(securityScheme: SecurityScheme, scopes: [String]?) async throws
    
    /**
     Authorizes an API request.

     - Parameters:
        - securityScheme: The security scheme to be used for authorization.
        - scopes: Optional scopes associated with the authorization.
        - request: The original URLRequest to be authorized.

     - Returns: An authorized URLRequest with the necessary authorization headers.

     - Throws: An error if the authorization process encounters an issue.
     */
    func authorize(securityScheme: SecurityScheme, scopes: [String]?, request: URLRequest) async throws -> URLRequest
}
